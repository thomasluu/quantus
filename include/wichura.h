#ifndef WICHURA_H
#define WICHURA_H

float ppnd7(const float p)
{
    float x, y;
    const float q = p - 0.5f;
    if (fabs(q) <= 0.425f)
    {
        const float r = 0.180625f - q * q;
        x = 59.109374720f;
        x = x * r + 159.29113202f;
        x = x * r + 50.434271938f;
        x = x * r + 3.3871327179f;
        x *= q;
        y = 67.187563600f;
        y = y * r + 78.757757664f;
        y = y * r + 17.895169469f;
        y = y * r + 1.0f;
    } else {
        float r = 1.0f - p;
        if (p < r) r = p;
        r = sqrt(-log(r));
        if (r <= 5.0f) {
            r -= 1.6f;
            x = 0.17023821103f;
            x = x * r + 1.3067284816f;
            x = x * r + 2.7568153900f;
            x = x * r + 1.4234372777f;
            y = 0.12021132975f;
            y = y * r + 0.73700164250f;
            y = y * r + 1.0f;
        } else {
            r -= 5.0f;
            x = 0.017337203997f;
            x = x * r + 0.42868294337f;
            x = x * r + 3.0812263860f;
            x = x * r + 6.6579051150f;
            y = 0.012258202635f;
            y = y * r + 0.24197894225f;
            y = y * r + 1.0f;
        }
        if (q < 0.0f) x = -x;
    }
    return x / y;
}

double ppnd16(const double p)
{
    double x, y;
    const double q = p - 0.5;
    if (fabs(q) <= 0.425) {
        const double r = 0.180625 - q * q;
        x = 2.5090809287301226727e+3;
        x = x * r + 3.3430575583588128105e+4;
        x = x * r + 6.7265770927008700853e+4;
        x = x * r + 4.5921953931549871457e+4;
        x = x * r + 1.3731693765509461125e+4;
        x = x * r + 1.9715909503065514427e+3;
        x = x * r + 1.3314166789178437745e+2;
        x = x * r + 3.3871328727963666080;
        x *= q;
        y = 5.2264952788528545610e+3;
        y = y * r + 2.8729085735721942674e+4;
        y = y * r + 3.9307895800092710610e+4;
        y = y * r + 2.1213794301586595867e+4;
        y = y * r + 5.3941960214247511077e+3;
        y = y * r + 6.8718700749205790830e+2;
        y = y * r + 4.2313330701600911252e+1;
        y = y * r + 1.0;
    } else {
        double r = 1.0 - p;
        if (p < r) r = p;
        r = sqrt(-log(r));
        if (r <= 5.0) {
            r -= 1.6;
            x = 7.74545014278341407640e-4;
            x = x * r + 2.27238449892691845833e-2;
            x = x * r + 2.41780725177450611770e-1;
            x = x * r + 1.27045825245236838258;
            x = x * r + 3.64784832476320460504;
            x = x * r + 5.76949722146069140550;
            x = x * r + 4.63033784615654529590;
            x = x * r + 1.42343711074968357734;
            y = 1.05075007164441684324e-9;
            y = y * r + 5.47593808499534494600e-4;
            y = y * r + 1.51986665636164571966e-2;
            y = y * r + 1.48103976427480074590e-1;
            y = y * r + 6.89767334985100004550e-1;
            y = y * r + 1.67638483018380384940;
            y = y * r + 2.05319162663775882187;
            y = y * r + 1.0;
        } else {
            r -= 5.0;
            x = 2.01033439929228813265e-7;
            x = x * r + 2.71155556874348757815e-5;
            x = x * r + 1.24266094738807843860e-3;
            x = x * r + 2.65321895265761230930e-2;
            x = x * r + 2.96560571828504891230e-1;
            x = x * r + 1.78482653991729133580;
            x = x * r + 5.46378491116411436990;
            x = x * r + 6.65790464350110377720;
            y = 2.04426310338993978564e-15;
            y = y * r + 1.42151175831644588870e-7;
            y = y * r + 1.84631831751005468180e-5;
            y = y * r + 7.86869131145613259100e-4;
            y = y * r + 1.48753612908506148525e-2;
            y = y * r + 1.36929880922735805310e-1;
            y = y * r + 5.99832206555887937690e-1;
            y = y * r + 1.0;
        }
        if ( q < 0.0 ) x = -x;
    }
    return x / y;
}

#endif // WICHURA_H
